// Copyright 2022 The fftea authors
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     https://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

// Test cases generated with numpy as a reference implementation, using:
// python3 test/generate_fft_test_cases.py

import 'dart:typed_data';
import 'package:test/test.dart';
import 'package:fftea/fftea.dart';

void testFft(List<double> inp, List<double> exp) {
  final buf = ComplexArray(Float64List.fromList(inp));
  final fft = FFT(buf.length);
  fft.inPlaceFft(buf);
  expect(buf.length, inp.length / 2);
  expect(buf.array.length, exp.length);
  for (int i = 0; i < buf.array.length; ++i) {
    expect(buf.array[i], closeTo(exp[i], 1e-6));
  }
  fft.inPlaceInverseFft(buf);
  expect(buf.array.length, inp.length);
  for (int i = 0; i < buf.array.length; ++i) {
    expect(buf.array[i], closeTo(inp[i], 1e-6));
  }
}

void testRealFft(List<double> inp, List<double> exp) {
  final fft = FFT(inp.length);
  final buf = fft.realFft(inp);
  expect(buf.length, inp.length);
  expect(buf.array.length, exp.length);
  for (int i = 0; i < buf.array.length; ++i) {
    expect(buf.array[i], closeTo(exp[i], 1e-6));
  }
  final a = fft.realInverseFft(buf);
  expect(a.length, inp.length);
  for (int i = 0; i < a.length; ++i) {
    expect(a[i], closeTo(inp[i], 1e-6));
  }
}

main() {
  test('ComplexArray', () {
    final a = ComplexArray(Float64List.fromList([-4.24926712, 0.43567775, 2.51713706, -7.76003700]));
    expect(a.length, 2);
    expect(a.array.length, 4);

    final b = a.copy();
    expect(b.length, 2);
    expect(b.array.length, 4);
    expect(b.array[0], a.array[0]);
    expect(b.array[1], a.array[1]);
    expect(b.array[2], a.array[2]);
    expect(b.array[3], a.array[3]);
    b.array[1] = 12345;
    expect(b.array[1], isNot(a.array[1]));

    final c = ComplexArray.fromRealArray([123, 456]);
    expect(c.length, 2);
    expect(c.array.length, 4);
    expect(c.array[0], 123);
    expect(c.array[1], 0);
    expect(c.array[2], 456);
    expect(c.array[3], 0);

    final sqmag = a.squareMagnitudes();
    expect(sqmag.length, 2);
    expect(sqmag[0], closeTo(18.24608615, 1e-6));
    expect(sqmag[1], closeTo(66.55415322, 1e-6));

    final mag = a.magnitudes();
    expect(mag.length, 2);
    expect(mag[0], closeTo(4.27154376, 1e-6));
    expect(mag[1], closeTo(8.15807288, 1e-6));

    final real = a.toRealArray();
    expect(real.length, 2);
    expect(real[0], -4.24926712);
    expect(real[1], 2.51713706);
  });

  test('FFT', () {
    testFft(
      [-5.64587693, 6.88227824],
      [-5.64587693, 6.88227824],
    );
    testFft(
      [-9.31854252, -0.43631919, -3.16343887, 0.87887206],
      [-12.48198139, 0.44255287, -6.15510365, -1.31519125],
    );
    testFft(
      [
        7.18372777, 9.13083398, -5.70872268, 7.85940578, //
        0.84410787, 4.88369054, -5.87865320, -9.13685074,
      ],
      [
        -3.55954025, 12.73707956, 23.33587642, 4.07721292, //
        19.61521153, 15.29196949, -10.65663661, 4.41707396,
      ],
    );
    testFft(
      [
        6.65499146, 0.74523348, 9.89296312, -1.75647873, //
        8.38009508, 5.65048929, -4.70732320, -9.36011010, //
        -4.02190010, -0.65188895, -8.67117712, 7.05709552, //
        7.05317210, 6.56301757, -6.80726353, 3.32785599,
      ],
      [
        7.77355780, 11.57521407, 6.20242571, -11.80190329, //
        -1.46730493, -24.85653507, -15.25641255, -14.62727483, //
        28.35915927, 13.03848870, 13.32630086, 11.94230220, //
        -24.13304673, 0.61621041, 38.43525221, 20.07536566,
      ],
    );
    testFft(
      [
        -3.58641196, -4.67940214, 2.90881979, -7.47509266, //
        -1.80965101, 9.88956926, 4.36433496, 0.38755486, //
        3.91761605, 1.46175692, 6.04498165, -0.54796627, //
        -2.46113684, 4.36852665, 5.64794385, 2.93829421, //
        -0.77925976, 7.24566912, 8.91328762, 8.68714250, //
        4.34762826, 0.19261688, 3.61693538, 7.99375667, //
        4.28976333, 9.38354483, 7.81118107, -5.92278564, //
        -2.72628624, 8.91352545, -2.78342901, -4.97619911,
      ],
      [
        37.71631714, 37.86051155, -29.22016943, -24.51508516, //
        -8.02924406, -20.11917069, -1.31366665, -18.05434484, //
        -5.11095522, -24.78515446, -8.74996561, -31.20104961, //
        8.48326148, -0.79849527, 4.08757388, 20.83112707, //
        -35.33179349, 35.69110242, 5.96556611, 29.88312771, //
        -23.51659005, -11.88969952, 27.91158641, -18.34852279, //
        18.09326221, 4.87981544, -10.91119150, -20.37868882, //
        -27.22963176, -0.30877363, -10.22695078, -33.61713362,
      ],
    );
    testFft(
      [
        -1.99601941, 8.93179270, 8.73983672, 4.44498471, //
        -1.61351822, -6.49297584, 0.18593207, -6.29817112, //
        5.31203252, -9.74480465, -5.70645307, 0.50487713, //
        -7.71603218, 7.42684997, 2.46935409, -3.79616365, //
        -1.30348117, -5.26462923, -0.87682180, 7.00577797, //
        -4.23830163, -8.55054399, -9.37892951, 7.72174373, //
        -5.50596116, 8.48890599, -4.51811660, -3.64731244, //
        2.10977504, -3.64731364, 3.13875430, -7.03883545, //
        -3.41964349, -8.46949636, 0.50361117, -5.43597392, //
        3.14867454, -1.72476088, 3.25259547, 5.71235197, //
        7.24595017, 0.65659507, 0.79292185, 7.98140105, //
        -7.82363941, -9.92012701, 8.90118636, 2.73218080, //
        -4.59665281, -5.62157032, 9.52539281, 3.36314757, //
        -9.80561189, 2.04087001, 3.29190025, -7.03556567, //
        -2.06386693, 2.49826068, 7.22992048, 1.23850351, //
        -5.11349163, -6.85262340, -4.29215268, -9.44737673,
      ],
      [
        -14.12085577, -38.24000142, 0.65425088, 28.15110983, //
        10.73070268, -53.97601406, -21.89729859, 37.75084639, //
        20.08226915, -33.61557526, -6.03763131, 29.41753283, //
        -15.20661669, 25.79266122, 51.33908357, -27.62058897, //
        57.62974479, 11.07402748, 41.38619678, -8.04431302, //
        -23.44410616, -12.14302073, 2.19291237, 47.12118621, //
        -23.06095401, -1.25222585, 11.67819332, -46.35496134, //
        50.88920150, 49.38245449, -29.53114506, 65.36783940, //
        -60.63871957, -34.25114034, -16.23644568, -21.23343703, //
        -1.24430189, 18.37507733, 8.51661806, -23.50740831, //
        -56.15856532, -3.09940727, 4.73032804, 71.89973449, //
        25.47322360, 46.59503049, -3.22371108, 19.20535825, //
        -8.18073860, 27.31732986, -26.89147116, 26.40106291, //
        -64.40591532, 12.62669787, -1.28676479, 82.98258114, //
        -6.07855570, -11.32423278, 4.96110052, 32.62821069, //
        21.08358090, 4.13508049, 2.42376951, -35.74412856,
      ],
    );
    testFft(
      [
        -6.38900399, 8.83615472, 8.18494880, -1.12737489, //
        5.05130147, -1.42727561, 6.56731751, -3.59748376, //
        6.83106879, 5.67878470, -0.73431507, 4.35654316, //
        3.17727083, -3.44133083, -0.32321971, -9.28508771, //
        -2.31160924, 6.66420023, 9.59666313, -4.06971817, //
        5.91584746, 7.25708919, 2.77209098, -5.82726415, //
        -6.40517670, 3.30797868, 2.05595067, -6.75272247, //
        6.96694120, -0.09381917, 4.64111294, -2.48198582, //
        -6.64507927, 3.97717248, 5.57892841, -8.59969845, //
        -2.12397464, -2.88480555, -9.48937033, -6.08303451, //
        -0.07432606, -4.36461853, 9.14922577, 4.79755462, //
        -1.70476411, 4.59003891, 4.21596609, 7.48406004, //
        6.43417404, 2.07320972, -2.20200540, -0.09671034, //
        -8.98494403, -0.68387863, -9.46280518, 9.76461576, //
        0.21339989, -4.54086286, 0.77895485, -6.42899260, //
        5.61000495, 8.59054557, -4.06294452, -8.27493086, //
        2.32719478, 0.72959522, -2.31272564, 3.67490165, //
        5.73162032, 9.10724475, -8.43760097, -2.70189055, //
        1.70479129, 9.78049897, 8.02500959, 2.62460960, //
        6.10092452, -0.83485992, -6.97536522, -6.46850213, //
        -3.18547442, -2.73014185, 9.48347315, 3.71515961, //
        2.24794724, -6.59380714, 4.04104554, -2.97142143, //
        6.47259946, -5.57266297, -6.75588039, -1.11749870, //
        3.32041890, -0.79660697, 7.89136155, 1.41194122, //
        -1.39398961, 5.95333916, 1.65724818, 6.83576454, //
        0.75678326, -7.23882996, 9.83179480, 6.44593490, //
        7.04108137, 0.13622838, 8.19895345, 5.83573374, //
        -9.28102399, 9.74131662, 2.19248528, 6.89204335, //
        -5.69147116, 1.35712242, 5.55868623, -8.38260760, //
        3.80365178, 5.00236091, -3.24292061, 7.38385429, //
        3.51563272, 5.01236037, -1.85132198, -4.59649070, //
        -3.88060729, -1.25611481, 2.92704402, 2.28074269,
      ],
      [
        82.64899571, 39.97567057, -1.46516524, 32.30724767, //
        -72.84989265, -10.28034539, 12.55626071, -51.32414018, //
        36.38847373, -41.88715554, -40.59775105, 32.10862598, //
        70.91009889, -3.96115342, -62.36233183, -24.27881075, //
        -22.75635209, 3.75443735, 16.67106624, -89.81092778, //
        -4.99703780, -60.60704030, 8.92372074, 21.71834777, //
        -6.49083473, 118.50959464, -32.53527220, 74.92769034, //
        -27.30620717, -9.92387040, -2.02056942, 39.67984206, //
        -23.56672434, -34.06471010, -53.57816779, 78.98800858, //
        30.37031798, -39.31798568, 70.29006802, -15.82028133, //
        -25.44020441, -12.08189082, -37.47756390, 28.74044656, //
        63.18975609, -21.24836867, -66.74740941, -4.16662174, //
        -43.77381719, 32.85674370, -47.23457202, 25.35309437, //
        -51.96146951, 16.51486238, -35.07796984, -50.53330459, //
        30.20338112, 2.82881548, 41.39453107, -45.25775646, //
        7.45540030, 59.91260766, -111.06144248, 21.96409699, //
        -32.34657617, 70.69558185, -3.16702304, 22.81045939, //
        91.31022957, 15.40132103, -49.70515729, -63.24180826, //
        -1.92038003, 37.44168550, -62.00264290, -12.06136973, //
        -22.68410371, -2.99142532, -8.94872663, 47.66007781, //
        -77.47445006, 26.91331769, 5.89212805, -28.43910207, //
        27.36215920, -22.40420043, 24.78875163, 32.59149719, //
        -68.15163451, -44.91423164, 56.74936809, 42.24671710, //
        -28.06026714, -89.13338939, -7.90286631, -9.55494477, //
        -16.96044765, 68.58689304, 29.82326517, 18.82521629, //
        31.83404361, 127.03984899, -22.64947274, 2.04237463, //
        13.68244271, 18.23020499, 9.17361136, 20.62694455, //
        -64.37025277, -55.72298884, 23.63336388, 83.98461273, //
        -0.61269922, 6.16728272, -38.93690913, 22.38248380, //
        -15.22046323, 20.65373805, 57.79644706, 24.78311558, //
        -37.04322239, 18.92794580, -13.78674978, -10.02539212, //
        28.65384295, 70.23220242, 60.64682040, -9.81653566,
      ],
    );
    testFft(
      [
        2.68721475, -7.68987900, 7.66198246, 6.41886812, //
        -9.95376578, -6.09432789, -2.49514781, -3.54939300, //
        -0.15002802, -7.94152952, -6.08294901, -7.28257472, //
        8.44619882, 0.75269873, 9.61169702, -0.32156855, //
        2.58943109, 2.12580944, 7.22765174, 9.97356618, //
        4.35823469, 6.59508396, -7.81221593, 4.48077649, //
        -6.79187488, -7.23234810, 9.70247576, 2.91268710, //
        0.42759927, -9.36539827, 2.50703654, -9.43452980, //
        -9.32562341, -2.08201594, 4.21453566, -9.14325539, //
        9.47862994, 0.42900333, 8.59056184, -2.87319896, //
        -4.48061498, 4.13763972, 6.48699768, 9.11284884, //
        -1.74279376, 9.13525744, -8.61222153, -6.53749070, //
        8.99717512, -8.30648399, 7.36834742, -2.91717008, //
        -8.24717292, 1.27301840, -3.26348279, 7.39900377, //
        2.86753440, 6.90996078, -6.87750766, -7.05045808, //
        5.17579637, 1.49422243, -3.74824786, 7.04486174, //
        9.06337132, -0.84351466, 7.30094010, 6.82400140, //
        -5.51086914, -7.84300548, 3.32212264, -8.16359014, //
        7.51664145, 7.47934649, -8.40127026, -7.97688817, //
        -4.49444823, -8.56619173, 5.27407936, 0.37588204, //
        -0.59661505, 4.06693694, 1.72172784, -2.75329395, //
        0.46687821, -2.92463075, 5.86032154, 8.75143670, //
        -6.89897902, -8.89105681, -7.80775681, 6.71734429, //
        6.62353233, -1.52182349, 7.05237006, 3.44455216, //
        1.33746199, -5.29943827, -4.53560547, 4.20785909, //
        -9.77528639, -0.81541908, -0.38266554, -9.39922289, //
        9.67435169, 3.37840937, -6.75303699, -5.80732386, //
        4.09477936, -9.97958198, 5.24814452, 0.89030740, //
        8.86554669, 0.38994939, -3.94471362, -6.88799526, //
        6.69846095, 4.02095047, 5.17918659, 0.84915047, //
        6.23126942, -5.20059251, 5.02643103, 3.34740095, //
        -6.86897802, -7.30078160, -7.11124060, 9.08208925, //
        4.21601651, -9.19539685, 4.46053611, 9.68105616, //
        9.64862568, 1.27700038, -9.97799869, -9.73609704, //
        -1.96147908, -9.41501463, 7.61896452, -2.58744246, //
        2.20772452, -6.50483487, -3.36013667, -1.40751069, //
        7.63842054, -0.51038668, 4.91864926, -5.04268910, //
        -4.22613437, 3.93721296, -7.77159155, 1.33967403, //
        -5.02651539, 9.56659147, -6.90024236, 5.05092674, //
        -1.17526878, -4.18986692, -8.66230143, 1.86752519, //
        4.32771961, 8.42475734, -3.81906561, -5.69907021, //
        8.12092343, -6.34894709, 4.90486563, 2.45462300, //
        3.33022558, -0.66770058, 0.83962554, 6.18960249, //
        7.16828898, 4.60138598, -9.94235155, -8.17360370, //
        8.61243322, -1.98508578, 6.95327893, 7.60126997, //
        -8.03984226, 3.83186003, 6.08312280, -8.94696147, //
        5.44686448, 7.09495742, 8.47516937, 9.01408037, //
        0.41472350, -7.15059611, -4.57267043, -4.37644371, //
        5.89467550, 6.56693095, -1.69023624, -9.76402534, //
        -4.55434562, -5.00856729, 3.81030931, -5.21698961, //
        9.42599523, -6.76097204, 6.44588427, 8.96455355, //
        -8.13595202, 5.59434090, -3.43768838, -4.12124418, //
        -9.37970147, -9.83537752, 6.10840047, -5.53747169, //
        5.43381576, -1.61115538, -1.40119469, 2.35117825, //
        -1.16842258, -8.95951968, -9.57009509, 0.48483070, //
        -0.49041092, -7.33061879, 0.95232851, -0.82953013, //
        3.53009664, -5.07404644, 1.18685752, -1.29249595, //
        6.80310291, -0.76243247, -3.76591943, 0.81135565, //
        6.11445106, -0.08214937, 6.74365200, -3.19062096, //
        -8.16313609, -1.32962330, -0.93101282, -1.48152594, //
        0.72336865, -5.02547150, -8.84431021, -5.58024157, //
        -7.61013066, 4.69733925, -8.40122480, 0.15397834, //
        -7.89904800, -0.86634472, 2.17213167, -2.72889090, //
        3.91976194, 8.30810826, -0.60180714, 8.94269091,
      ],
      [
        75.46238146, -109.49418210, -13.83559153, -23.84325196, //
        37.64725059, -45.50792303, -50.71541709, -18.75190902, //
        -20.15689787, 30.85193516, -63.55939471, -25.40417297, //
        11.53504962, -30.18972841, 59.77325334, -75.07616380, //
        -96.77677909, -83.63342893, 97.07660444, -37.17259036, //
        -142.43315956, 39.85254070, -47.40615876, 62.16920027, //
        -66.57074427, 149.16794166, -13.57092195, 70.87416924, //
        120.75033383, 121.64622063, -24.29202147, 94.16354179, //
        48.94848728, -44.08821843, 41.96277360, -74.07905827, //
        46.79635078, 88.82298247, 62.85575996, 147.00714196, //
        15.61066694, 13.92511788, -36.87877001, -56.88090947, //
        35.65859388, -189.96406693, -38.71336250, 1.75200838, //
        -40.46997388, 145.90462199, -59.20556188, 74.51327067, //
        4.41656638, -35.78897470, -68.79460077, -18.05439009, //
        67.38100206, -125.28933768, 5.70960137, 144.93307843, //
        -2.23145879, -65.68743477, -100.51779599, -129.24583203, //
        94.50162478, -78.28513864, 13.55672764, -27.22390254, //
        -136.33734506, -75.75481142, 23.80285020, 61.08655488, //
        90.30912346, -2.90783716, 39.65950979, 17.46167327, //
        -101.65964932, -155.91719166, 108.44991505, 82.29930170, //
        5.78083969, -25.97163523, -115.89867916, -77.75119359, //
        187.81836516, 9.32101064, 84.00081386, -88.50169332, //
        -28.82294376, -171.00672234, -11.40240710, -129.36169450, //
        -23.18037898, 99.19514510, 107.02502502, 18.67925183, //
        -38.68226839, -57.41558274, -48.59409655, 19.68613907, //
        -25.04624842, -30.15708295, 86.63108361, -49.10512749, //
        67.22449945, -44.75151599, -56.89107689, -64.85469426, //
        -67.41532992, -20.52470276, 21.46379188, -98.29566664, //
        -32.83385697, -54.69694659, -31.41412252, 80.98769617, //
        4.97449459, -51.53086591, 60.66117220, 117.28075919, //
        56.23464581, -55.60380279, 23.79324442, -42.35180857, //
        -34.19695522, -53.51927821, -68.70117376, -15.61884371, //
        56.35742808, -71.35252834, -93.67057856, 38.86138098, //
        76.34433626, -41.43943696, -13.71266001, 69.14712342, //
        -70.82063449, 37.84139727, -13.76178508, -55.29440645, //
        -67.28651373, -128.80495244, -16.95074315, 63.12268602, //
        80.52901974, -96.57255050, -19.69863896, 43.57446849, //
        -40.25409689, -7.98333259, -38.02263392, -30.11355988, //
        -24.28647897, -111.84578246, -81.20695548, 77.45784356, //
        -25.39008583, -60.51054242, -63.61115544, -57.77060210, //
        72.96532672, 39.07602442, -100.47362296, 48.36353372, //
        70.04506032, -136.25375012, 6.22214162, 41.51350093, //
        13.45840768, 32.78381855, -37.33142215, 146.49538531, //
        -4.37063506, 80.27651916, 72.90746063, -30.12755456, //
        -34.68072358, 30.68366729, -12.03990961, 108.46608261, //
        -69.18054795, -93.94562091, 80.77410140, -8.53726012, //
        74.26621959, -11.25580930, 62.72294096, -97.66466671, //
        -111.84542965, -109.21560702, 20.18010618, -14.15308550, //
        35.32401800, 52.23970799, -57.55099294, -57.65829317, //
        87.51382966, 48.78706389, -33.58699944, 55.97007491, //
        74.78490635, 88.11917095, 53.83715223, -76.49868836, //
        -88.21397027, -62.18877526, 3.06972698, -31.01736583, //
        -21.58405757, 50.89278404, -3.67297714, 8.39353613, //
        59.56785768, 84.98493274, 0.54740295, -69.72055983, //
        -43.57608419, 71.73078793, 51.42432546, -68.90997808, //
        23.71763955, 27.17502946, 11.06222143, -21.34291349, //
        48.57093584, -4.86178264, 19.02248640, -65.61889904, //
        -8.97780524, 3.65807068, 27.66685873, 24.49583883, //
        91.71550690, 2.66489188, 183.56658446, -65.56826896, //
        24.43797967, 14.09086009, 36.82009155, -17.83605672, //
        94.28252445, 64.49354264, -9.67547950, -23.15354706, //
        -14.31233954, 39.04352215, -78.57488668, 74.49904915, //
        55.11477721, -18.52211356, 1.94511808, 136.00007160, //
        -86.64585664, 14.55203254, -42.10156437, 9.65738850,
      ],
    );
  });

  test('Real FFT', () {
    testRealFft(
      [9.16698417],
      [9.16698417, 0.00000000],
    );
    testRealFft(
      [6.53179229, 4.53984164],
      [11.07163393, 0.00000000, 1.99195065, 0.00000000],
    );
    testRealFft(
      [9.40550082, 3.07552599, 2.18100192, -8.95142155],
      [
        5.71060718, 0.00000000, 7.22449891, -12.02694754, //
        17.46239831, 0.00000000, 7.22449891, 12.02694754,
      ],
    );
    testRealFft(
      [
        -9.90871632, 4.98446344, -3.21664921, 9.31107245, //
        -2.90503278, 9.94190151, 3.70950660, 5.37272957,
      ],
      [
        17.28927526, 0.00000000, -13.29395057, 7.64676494, //
        -13.30660648, -0.24256293, -0.71341652, -6.20554669, //
        -41.93105867, 0.00000000, -0.71341652, 6.20554669, //
        -13.30660648, 0.24256293, -13.29395057, -7.64676494,
      ],
    );
    testRealFft(
      [
        -1.70116084, -3.29334427, -7.86209701, 4.70381888, //
        2.04700343, -4.01498386, -3.02024427, 7.48395626, //
        1.77921685, -1.58952213, -2.26265763, 2.82150202, //
        6.92226884, -0.95634086, 2.40361228, 4.78524733,
      ],
      [
        8.24627504, 0.00000000, -5.78111838, 13.37596966, //
        -5.47423517, 12.80000479, -9.60584927, 1.55006581, //
        19.78871491, 29.64871560, 2.89340552, -4.28869795, //
        -12.30819736, -6.21624050, -1.42794864, -11.96385576, //
        -11.63439173, 0.00000000, -1.42794864, 11.96385576, //
        -12.30819736, 6.21624050, 2.89340552, 4.28869795, //
        19.78871491, -29.64871560, -9.60584927, -1.55006581, //
        -5.47423517, -12.80000479, -5.78111838, -13.37596966,
      ],
    );
    testRealFft(
      [
        0.79223765, 3.41706624, -7.92919767, 5.15508345, //
        -6.79222143, -1.42308640, -0.82061211, -8.94374123, //
        -4.54727375, -0.01796336, 2.52344767, -7.68825538, //
        -7.69833131, -4.54245468, 3.20873330, 5.07264430, //
        8.65636494, 0.43090705, -5.12518995, -5.97169493, //
        2.35531181, 3.12994154, 1.66465587, -3.83869959, //
        -1.34929800, -0.22968919, -4.73658686, 8.33627819, //
        -1.19373201, 9.02671901, 5.07655003, 4.38107610,
      ],
      [
        -9.62101069, 0.00000000, 13.79315463, 34.19056787, //
        37.77078135, 19.33373703, -8.55737471, 14.31124953, //
        12.81448186, 23.99427465, -39.76988222, -21.77134599, //
        26.61323645, 32.51913452, -3.65853804, -12.04938037, //
        -3.63874239, -13.28874929, -6.61880255, 21.72898779, //
        8.88545088, -2.24651536, 10.48885917, -18.31869345, //
        20.94752571, -24.79943313, 13.85723467, -13.71511114, //
        -11.88877129, 2.38870195, -42.44766925, 10.90611676, //
        -22.20927291, 0.00000000, -42.44766925, -10.90611676, //
        -11.88877129, -2.38870195, 13.85723467, 13.71511114, //
        20.94752571, 24.79943313, 10.48885917, 18.31869345, //
        8.88545088, 2.24651536, -6.61880255, -21.72898779, //
        -3.63874239, 13.28874929, -3.65853804, 12.04938037, //
        26.61323645, -32.51913452, -39.76988222, 21.77134599, //
        12.81448186, -23.99427465, -8.55737471, -14.31124953, //
        37.77078135, -19.33373703, 13.79315463, -34.19056787,
      ],
    );
    testRealFft(
      [
        0.80283238, 2.64114841, 7.22933627, -4.87013586, //
        -2.46003040, 8.82054458, 3.48191461, 1.74374430, //
        -8.34974260, -4.74421130, -9.90810427, 8.31921906, //
        -2.25030437, -5.68512039, 2.91840915, -7.41615200, //
        -0.76902121, 8.15457709, 7.23502403, -6.57528104, //
        4.75113265, -2.10183369, 9.04278527, -3.83058497, //
        -7.74797021, -0.53810809, 0.13401956, 4.95096647, //
        -6.77954564, 9.30551828, 5.12102476, 4.09291053, //
        5.69180035, 2.53584444, 4.46548510, -8.70461374, //
        2.81425128, -3.61742772, -1.02023036, -1.44034936, //
        -9.36315285, 0.62374848, 4.43236137, 8.21333892, //
        -2.49347888, -0.16937080, 3.25017878, 3.47550083, //
        -0.47735943, 2.53596810, -6.79750451, -9.70361283, //
        4.74552207, -9.12055688, -4.22085654, 9.32083996, //
        7.06467102, 5.48715943, 2.56852271, 8.37905881, //
        -1.86480797, 0.43471727, 3.50899933, -3.34876483,
      ],
      [
        31.92484295, 0.00000000, 1.36202676, 7.86586560, //
        35.92502909, 33.91999942, 16.70996355, 10.51219503, //
        26.02459575, 26.66118758, -90.28623234, -42.73930130, //
        -2.54642854, -22.85646988, 0.30973861, -33.46995326, //
        5.53403319, 1.23864443, 12.39747786, 25.33674680, //
        4.48933318, 39.32955340, 22.98347238, -9.44522471, //
        56.12505993, -30.82978539, -48.98809957, -34.27509583, //
        -19.52425089, -28.76762599, 39.95343185, -18.47451717, //
        -48.12656904, -11.95651297, -5.35037809, 38.05164445, //
        -13.24117387, -0.03591861, -53.20242483, -10.61174135, //
        -40.54359904, -66.85600489, -7.44425315, 16.05960823, //
        29.68875695, 37.00195728, 25.67406893, 11.17996111, //
        -24.75539576, -24.20752505, -12.20926969, -22.10725844, //
        36.22357876, 28.10809022, 11.85659589, -17.40552575, //
        52.97173021, 83.59101792, 19.73356779, -41.72245208, //
        -9.08673769, -20.29290703, -11.72317339, 9.51797513, //
        -2.41252004, 0.00000000, -11.72317339, -9.51797513, //
        -9.08673769, 20.29290703, 19.73356779, 41.72245208, //
        52.97173021, -83.59101792, 11.85659589, 17.40552575, //
        36.22357876, -28.10809022, -12.20926969, 22.10725844, //
        -24.75539576, 24.20752505, 25.67406893, -11.17996111, //
        29.68875695, -37.00195728, -7.44425315, -16.05960823, //
        -40.54359904, 66.85600489, -53.20242483, 10.61174135, //
        -13.24117387, 0.03591861, -5.35037809, -38.05164445, //
        -48.12656904, 11.95651297, 39.95343185, 18.47451717, //
        -19.52425089, 28.76762599, -48.98809957, 34.27509583, //
        56.12505993, 30.82978539, 22.98347238, 9.44522471, //
        4.48933318, -39.32955340, 12.39747786, -25.33674680, //
        5.53403319, -1.23864443, 0.30973861, 33.46995326, //
        -2.54642854, 22.85646988, -90.28623234, 42.73930130, //
        26.02459575, -26.66118758, 16.70996355, -10.51219503, //
        35.92502909, -33.91999942, 1.36202676, -7.86586560,
      ],
    );
    testRealFft(
      [
        2.61475101, -9.82252470, -6.59596811, -1.70863949, //
        -3.91399962, -7.18400006, -6.17860246, -1.63317159, //
        -6.73498784, -8.53684595, 0.79410169, -9.22824949, //
        -9.20532316, -5.62120957, 7.59609613, -1.55065771, //
        1.97632092, 2.09424316, -7.30221568, 2.20844295, //
        1.98460196, 3.85115868, -6.15944178, 6.73169944, //
        -8.78829022, 0.77798734, 4.83383020, 5.06804044, //
        7.18621186, -7.57665607, 7.41981059, 5.45802907, //
        6.74661753, 9.43838386, -3.62998671, 9.03416376, //
        -7.30489764, -7.59203301, -3.81529845, -1.55973803, //
        3.02028136, 9.08275728, -9.03874302, -1.78604830, //
        -9.69060077, -4.58426359, -3.20253998, -4.40643155, //
        -4.87218824, -2.44819637, -2.11605644, -1.08611275, //
        9.79426523, -0.39084258, -2.87254452, 3.92459992, //
        0.36431337, -4.63920229, 2.65599034, -5.89685466, //
        -6.60528399, 8.62213263, 0.60896465, -5.44853807, //
        3.53706893, 3.55647681, -0.15431603, 1.16099586, //
        1.61883585, -8.76741721, 0.90761317, 0.79548022, //
        -9.75278004, 4.29065262, 1.44497467, -1.90855798, //
        -5.54391632, 7.67722333, 7.53288733, -5.42750349, //
        -0.84825665, -8.26100643, 7.85788200, 1.30085800, //
        -2.19441220, 7.47059890, -8.07894873, -9.27195697, //
        5.20580219, -2.17783076, -9.16869545, -2.40992645, //
        6.80459197, 9.94940090, 5.38541010, -5.47612528, //
        5.22924636, 8.38890233, -1.88078967, -0.29629732, //
        -3.78828157, 4.01269962, -3.27553474, -4.03452897, //
        -8.68131751, -5.70548346, -9.24347739, 2.11682763, //
        0.29527001, 7.21298633, 8.31544679, -1.75119266, //
        -8.35828716, 1.43410972, 6.33309040, 4.88401634, //
        -6.87870395, -0.22225788, 3.02209650, -0.29501519, //
        -6.47493258, -5.45338658, -2.60912286, -2.11044865, //
        9.26781604, -9.95873157, -7.56006328, 4.25159235,
      ],
      [
        -103.59803881, 0.00000000, -51.05891124, 7.16722431, //
        -84.38854613, -8.72415382, -71.55384516, 65.76298421, //
        34.29385312, 85.75109787, -2.23272122, -6.67390360, //
        -65.09121628, -4.21527843, 44.92768208, -22.05064550, //
        108.92767272, 5.60490178, 0.89145964, 52.18158428, //
        -11.68743634, -40.62491401, -67.21053482, -4.44540797, //
        48.70330738, 27.68912992, -15.24530126, -20.70823081, //
        -6.49498590, 12.49666999, 25.15948555, 91.56909381, //
        -24.55356840, 17.45510910, -39.82117331, -55.20471208, //
        3.80351457, 5.83780321, 63.90952566, -18.24684346, //
        37.06835569, -72.45571544, -43.84063021, 22.03646762, //
        -33.19325111, 29.46093181, 1.68998143, 18.05797288, //
        -48.08983235, 7.64128121, 105.95983014, -53.74078171, //
        49.81500392, -1.41880450, -1.64482962, 21.99886539, //
        76.27732489, -24.89244695, 98.69935825, 66.71326233, //
        -17.22005882, 32.84216107, -64.56549821, 77.50390318, //
        -15.81631418, -9.26907403, 62.91611599, 43.24276219, //
        -32.94940109, 43.16763737, 10.25855150, -36.65798250, //
        66.85994591, 59.92166118, 35.35625966, 76.01792529, //
        80.61377934, 2.73105263, 16.54074045, 64.78384929, //
        31.34954629, -42.12578584, -54.41832128, 15.67062596, //
        37.37904121, -29.84773073, -93.21214476, 95.52125387, //
        37.41615291, -14.12362903, -5.00456801, 29.98846978, //
        -44.09696124, 68.00039421, -3.51138940, -49.98486692, //
        9.26794390, -37.47459770, -48.29981268, 46.85266815, //
        -1.51909449, 40.16974203, 57.60659678, -14.81741864, //
        -72.14036840, -25.07087285, -13.43654810, -4.34242243, //
        17.61627609, 68.32914853, 14.65686252, -70.61495638, //
        59.28134925, -56.92759555, -34.45788228, -58.53965605, //
        -46.49803535, 6.38501274, 4.36620602, 30.27586850, //
        13.36218817, -40.17245750, 35.91179843, 23.47896674, //
        60.72666845, 35.03614716, 1.14948410, -15.95954242, //
        -40.73119242, 0.00000000, 1.14948410, 15.95954242, //
        60.72666845, -35.03614716, 35.91179843, -23.47896674, //
        13.36218817, 40.17245750, 4.36620602, -30.27586850, //
        -46.49803535, -6.38501274, -34.45788228, 58.53965605, //
        59.28134925, 56.92759555, 14.65686252, 70.61495638, //
        17.61627609, -68.32914853, -13.43654810, 4.34242243, //
        -72.14036840, 25.07087285, 57.60659678, 14.81741864, //
        -1.51909449, -40.16974203, -48.29981268, -46.85266815, //
        9.26794390, 37.47459770, -3.51138940, 49.98486692, //
        -44.09696124, -68.00039421, -5.00456801, -29.98846978, //
        37.41615291, 14.12362903, -93.21214476, -95.52125387, //
        37.37904121, 29.84773073, -54.41832128, -15.67062596, //
        31.34954629, 42.12578584, 16.54074045, -64.78384929, //
        80.61377934, -2.73105263, 35.35625966, -76.01792529, //
        66.85994591, -59.92166118, 10.25855150, 36.65798250, //
        -32.94940109, -43.16763737, 62.91611599, -43.24276219, //
        -15.81631418, 9.26907403, -64.56549821, -77.50390318, //
        -17.22005882, -32.84216107, 98.69935825, -66.71326233, //
        76.27732489, 24.89244695, -1.64482962, -21.99886539, //
        49.81500392, 1.41880450, 105.95983014, 53.74078171, //
        -48.08983235, -7.64128121, 1.68998143, -18.05797288, //
        -33.19325111, -29.46093181, -43.84063021, -22.03646762, //
        37.06835569, 72.45571544, 63.90952566, 18.24684346, //
        3.80351457, -5.83780321, -39.82117331, 55.20471208, //
        -24.55356840, -17.45510910, 25.15948555, -91.56909381, //
        -6.49498590, -12.49666999, -15.24530126, 20.70823081, //
        48.70330738, -27.68912992, -67.21053482, 4.44540797, //
        -11.68743634, 40.62491401, 0.89145964, -52.18158428, //
        108.92767272, -5.60490178, 44.92768208, 22.05064550, //
        -65.09121628, 4.21527843, -2.23272122, 6.67390360, //
        34.29385312, -85.75109787, -71.55384516, -65.76298421, //
        -84.38854613, 8.72415382, -51.05891124, -7.16722431,
      ],
    );
  });
}
